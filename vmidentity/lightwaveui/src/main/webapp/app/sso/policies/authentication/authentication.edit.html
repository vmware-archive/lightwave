<div class="popup-container"><div class="header-20px">Update Authentication Policy</div><div class="error" ng-show="globals.popup_errors && !globals.popup_errors.success"><img src="../app/assets/error.png" width="16px" height="16px"> <button type="button" class="btn btn-xs btn-link pull-right" ng-click="globals.popup_errors = null;">X</button> {{globals.popup_errors.details}} {{globals.popup_errors.cause}}</div><div class="success" ng-show="globals.popup_errors && globals.popup_errors.success"><img src="../app/assets/success.png" width="16px" height="16px"> <button type="button" class="btn btn-xs btn-link pull-right" ng-click="globals.popup_errors = null;">X</button> {{globals.popup_errors.details}}</div><div class="row"><form name="editAuthenticationPolicyForm" ng-submit="updateAuthenticationPolicy(vm.policies.authenticationPolicy)" role="form"><div class="row content popup-content"><div class="popup-row col-xs-12"><div class="col-xs-4">Authentication based on:</div><div class="col-xs-8 form-group" ng-class="{ 'has-error': editAuthenticationPolicyForm.description.$invalid }"><input type="checkbox" autofocus="autofocus" id="passwordBasedAuthenticationEnabled" name="passwordBasedAuthenticationEnabled" ng-model="vm.policies.authenticationPolicy.passwordBasedAuthenticationEnabled" style="margin-right:5px"> Password <input type="checkbox" id="windowsBasedAuthenticationEnabled" name="windowsBasedAuthenticationEnabled" ng-model="vm.policies.authenticationPolicy.windowsBasedAuthenticationEnabled" style="margin-right:5px;margin-left: 5px"> Windows <input type="checkbox" id="certificateBasedAuthenticationEnabled" name="certificateBasedAuthenticationEnabled" ng-model="vm.policies.authenticationPolicy.certificateBasedAuthenticationEnabled" style="margin-right:5px;margin-left: 5px"> Smart Card</div><div ng-show="vm.policies.authenticationPolicy.certificateBasedAuthenticationEnabled"><div class="popup-row col-xs-12"><div class="col-xs-4"></div><div class="col-xs-8 form-group"><input type="checkbox" id="clientCertificatePolicy.failOverToCrlEnabled" name="clientCertificatePolicy.failOverToCrlEnabled" ng-model="vm.policies.authenticationPolicy.clientCertificatePolicy.failOverToCrlEnabled" class="pull-left" style="margin-right:5px"> Failover to CRL</div></div><div class="popup-row col-xs-12"><div class="col-xs-4"></div><div class="col-xs-8 form-group"><input type="checkbox" id="clientCertificatePolicy.revocationCheckEnabled" name="clientCertificatePolicy.revocationCheckEnabled" ng-model="vm.policies.authenticationPolicy.clientCertificatePolicy.revocationCheckEnabled" class="pull-left" style="margin-right:5px"> Revocation Check</div></div><div class="popup-row col-xs-12"><div class="col-xs-4"></div><div class="col-xs-8 form-group"><input type="checkbox" id="clientCertificatePolicy.ocspEnabled" name="clientCertificatePolicy.ocspEnabled" ng-model="vm.policies.authenticationPolicy.clientCertificatePolicy.ocspEnabled" class="pull-left" style="margin-right:5px"> User CRL from certificates</div></div><div class="popup-row col-xs-12"><div class="col-xs-4"></div><div class="col-xs-8 form-group"><input type="checkbox" id="clientCertificatePolicy.crlDistributionPointUsageEnabled" name="clientCertificatePolicy.crlDistributionPointUsageEnabled" ng-model="vm.policies.authenticationPolicy.clientCertificatePolicy.crlDistributionPointUsageEnabled" class="pull-left" style="margin-right:5px"> CRL Location</div></div><div class="popup-row col-xs-12"><div class="col-xs-4">OCSP URL Override</div><div class="col-xs-8 form-group"><input type="text" id="clientCertificatePolicy.ocspUrlOverride" name="clientCertificatePolicy.ocspUrlOverride" ng-model="vm.policies.authenticationPolicy.clientCertificatePolicy.ocspUrlOverride" class="form-control pull-left"></div></div><div class="popup-row col-xs-12"><div class="col-xs-4">CRL Distribution Point Override</div><div class="col-xs-8 form-group"><input type="text" id="clientCertificatePolicy.crlDistributionPointOverride" name="clientCertificatePolicy.crlDistributionPointOverride" ng-model="vm.policies.authenticationPolicy.clientCertificatePolicy.crlDistributionPointOverride" class="form-control pull-left"></div></div><div class="popup-row col-xs-12"><div class="col-xs-4">Certificate Policies</div><div class="col-xs-8 form-group"><input type="text" id="PolicyOID" name="PolicyOID" ng-model="vm.PolicyOID" class="form-control pull-left" style="display: inline;width:80%"> <button type="button" class="btn btn-default btn-xs pull-right" ng-click="addPolicyOid()">Add</button></div></div><div class="popup-row col-xs-12"><div class="col-xs-4"></div><div class="col-xs-8" style="padding:5px;overflow-y: scroll"><div ng-repeat="policyOid in  vm.policies.authenticationPolicy.clientCertificatePolicy.certPolicyOIDs" ng-if="vm.policies.authenticationPolicy.clientCertificatePolicy.certPolicyOIDs">{{policyOid}} <button type="button" class="btn btn-default btn-xs pull-right btn-popup-footer" ng-click="removePolicyOid(policyOid)">Remove</button></div></div></div><div class="popup-row col-xs-12"><div class="col-xs-4">Trusted CA Certificates</div><div class="col-xs-8 form-group"><input type="file" on-read-file="addCertificate(vm.policies.authenticationPolicy.clientCertificatePolicy.trustedCACertificates, contents)" id="certfilepath" name="certfilepath" ng-model="vm.certFilePath"></div></div><div class="popup-row col-xs-12"><div class="col-xs-4"></div><div class="col-xs-8" style="padding:5px;overflow-y: scroll"><div ng-repeat="certificate in  vm.policies.authenticationPolicy.clientCertificatePolicy.trustedCACertificates" ng-if="vm.policies.authenticationPolicy.clientCertificatePolicy.trustedCACertificates">{{ certificate.metadata.subject.length > 30 ? certificate.metadata.subject.substring(0,30) + '...' : certificate.metadata.subject; }} <button type="button" class="btn btn-default btn-xs pull-right btn-popup-footer" ng-click="removeCertificate(vm.policies.authenticationPolicy.clientCertificatePolicy.trustedCACertificates, certificate)">Remove</button></div></div></div></div></div></div><div class="popup-row col-xs-12"><button type="submit" class="btn btn-primary pull-right btn-popup-footer" ng-disabled="editAuthenticationPolicyForm.$invalid">SAVE</button> <button type="button" class="btn btn-default pull-right btn-popup-footer" ng-click="closeThisDialog('cancel')">CANCEL</button></div></form></div></div>